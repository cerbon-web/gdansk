<!-- Full-page loading shown while backend is being checked on startup -->
<div *ngIf="loading" class="loading-overlay">
  <div class="loading-box">
    <span class="spinner" aria-hidden="true"></span>
    <div style="margin-top:8px">{{ 'LOADING' | translate }}</div>
    <div *ngIf="apiMessage$ | async as apiMessage" style="margin-top:8px">{{ apiMessage }}</div>
  </div>
</div>

<!-- Error state when backend didn't respond -->
<div *ngIf="!loading && !initialized" class="error-box" style="text-align:center;padding:24px;">
  <h2>{{ 'ERROR_TITLE' | translate }}</h2>
  <p *ngIf="apiMessage$ | async as apiMessage">{{ apiMessage }}</p>
  <p>
    <button (click)="checkBackendConnectivity()">{{ 'RETRY' | translate }}</button>
  </p>
</div>

<!-- Main app content only rendered after successful backend response -->
<div *ngIf="!loading && initialized">
  <app-header (loginClicked)="openLogin()"></app-header>
  <main class="main-actions" role="main" aria-label="Main actions">
    <ng-container *ngIf="!showUsers">
      <button class="big-action-button" aria-label="{{ 'QURAN_CONTEST' | translate }}" (click)="openQuran()">
        <img src="assets/icons/quran_mushaf.png" class="icon raster" alt="Quran">
        <span class="btn-label">{{ 'QURAN_CONTEST' | translate }}</span>
      </button>
      <button class="big-action-button" aria-label="{{ 'DAILY_CONTEST' | translate }}" (click)="openDaily()">
        <img src="assets/icons/daily_checklist.svg" class="icon" alt="">
        <span class="btn-label">{{ 'DAILY_CONTEST' | translate }}</span>
      </button>
    </ng-container>

    
    
    <router-outlet></router-outlet>
    <app-users *ngIf="showUsers" (close)="closeUsers()"></app-users>
  </main>

  <app-login *ngIf="showLogin" (close)="onLoginClose()"></app-login>

</div>

<footer class="site-footer" *ngIf="createdAt">
  © {{ createdYear }} — {{ 'CREATED_AT' | translate }} {{ createdAt }}
</footer>
